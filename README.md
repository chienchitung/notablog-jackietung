# Notablog - å¾ Notion ç”Ÿæˆéœæ…‹éƒ¨è½æ ¼

> ä¸€å€‹å¼·å¤§çš„éœæ…‹ç¶²ç«™ç”Ÿæˆå™¨ï¼Œå°‡ Notion è³‡æ–™åº«è½‰æ›ç‚ºç²¾ç¾çš„éƒ¨è½æ ¼ç¶²ç«™

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)

## âœ¨ ç‰¹è‰²åŠŸèƒ½

- ğŸš€ **å¾ Notion ç›´æ¥ç”Ÿæˆ**ï¼šä½¿ç”¨ Notion ä½œç‚º CMSï¼Œç„¡éœ€è¤‡é›œçš„å¾Œå°ç®¡ç†
- ğŸ¨ **å¯è‡ªè¨‚ä¸»é¡Œ**ï¼šä½¿ç”¨ EJS æ¨¡æ¿å¼•æ“ï¼Œè¼•é¬†å®¢è£½åŒ–ç¶²ç«™å¤–è§€
- âš¡ **å¿«é€Ÿç”Ÿæˆ**ï¼šæ™ºèƒ½å¿«å–æ©Ÿåˆ¶ï¼Œåªæ›´æ–°è®Šæ›´çš„é é¢
- ğŸ”— **å…§éƒ¨é€£çµè½‰æ›**ï¼šè‡ªå‹•è™•ç† Notion å…§éƒ¨é€£çµ
- ğŸ–¼ï¸ **åœ–ç‰‡æœ¬åœ°åŒ–**ï¼šè‡ªå‹•ä¸‹è¼‰ Notion åœ–ç‰‡åˆ°æœ¬åœ°
- ğŸŒ **å¤–éƒ¨é€£çµæ”¯æ´**ï¼šå¯åœ¨ Notion ä¸­è¨­å®šå¤–éƒ¨é€£çµï¼Œè‡ªå‹•è·³éæ¸²æŸ“
- ğŸ“± **éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼šå…§å»ºçš„ pure-ejs ä¸»é¡Œæ”¯æ´å„ç¨®è£ç½®
- ğŸ§¹ **è‡ªå‹•åŒæ­¥æ¸…ç†**ï¼šè‡ªå‹•åµæ¸¬ä¸¦åˆªé™¤ Notion ä¸­å·²ç§»é™¤æˆ–å–æ¶ˆç™¼å¸ƒçš„å°æ‡‰æœ¬åœ°æª”æ¡ˆ

## ğŸ“¦ å®‰è£

### å‰ç½®éœ€æ±‚

- Node.js >= 15
- npm æˆ– yarn

### å¾åŸå§‹ç¢¼å®‰è£

```bash
# å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/YOUR_USERNAME/notablog.git
cd notablog

# å®‰è£ä¾è³´
npm install --legacy-peer-deps

# ç·¨è­¯å°ˆæ¡ˆ
npm run build:module
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. æº–å‚™ Notion è³‡æ–™åº«

åœ¨ Notion ä¸­å»ºç«‹ä¸€å€‹è³‡æ–™åº«ï¼ŒåŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š

| æ¬„ä½åç¨±    | é¡å‹   | èªªæ˜                           |
| ----------- | ------ | ------------------------------ |
| title       | æ¨™é¡Œ   | æ–‡ç« æ¨™é¡Œï¼ˆè‡ªå‹•ï¼‰               |
| tags        | å¤šé¸   | æ–‡ç« æ¨™ç±¤                       |
| publish     | å‹¾é¸æ¡† | æ˜¯å¦ç™¼å¸ƒ                       |
| inMenu      | å‹¾é¸æ¡† | æ˜¯å¦é¡¯ç¤ºåœ¨å°èˆªæ¬„               |
| inList      | å‹¾é¸æ¡† | æ˜¯å¦é¡¯ç¤ºåœ¨é¦–é åˆ—è¡¨             |
| template    | å–®é¸   | ä½¿ç”¨çš„æ¨¡æ¿ï¼ˆé€šå¸¸é¸ `post`ï¼‰    |
| url         | æ–‡å­—   | è‡ªè¨‚ç¶²å€ï¼ˆé¸å¡«ï¼Œæ”¯æ´å¤–éƒ¨é€£çµï¼‰ |
| description | æ–‡å­—   | æ–‡ç« æè¿°                       |
| date        | æ—¥æœŸ   | ç™¼å¸ƒæ—¥æœŸ                       |

### 2. å»ºç«‹å°ˆæ¡ˆç›®éŒ„

```bash
# ä½¿ç”¨ notablog-starter ä½œç‚ºç¯„æœ¬
mkdir my-blog
cd my-blog
```

åœ¨å°ˆæ¡ˆç›®éŒ„ä¸­å»ºç«‹ `config.json`ï¼š

```json
{
  "url": "ä½ çš„ Notion è³‡æ–™åº«ç¶²å€",
  "theme": "pure-ejs",
  "autoSlug": true
}
```

### 3. ç”Ÿæˆä¸¦é è¦½ç¶²ç«™

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ npm scriptsï¼ˆæ¨è–¦ï¼‰â­

```bash
# å¾ Notion åŒæ­¥æ•¸æ“šä¸¦ç”Ÿæˆç¶²ç«™ï¼ˆä¸ä½¿ç”¨ç·©å­˜ï¼‰
npm run sync

# å•Ÿå‹•æœ¬åœ°é è¦½ä¼ºæœå™¨
npm start
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨å®Œæ•´å‘½ä»¤

```bash
# å¾å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œç”Ÿæˆå‘½ä»¤
node bin/cli.js generate notablog-starter

# å•Ÿå‹•æœ¬åœ°é è¦½ä¼ºæœå™¨
node bin/cli.js preview notablog-starter
```

åŸ·è¡Œé è¦½å‘½ä»¤å¾Œï¼Œæ‰“é–‹ç€è¦½å™¨è¨ªå• **http://localhost:3000** å³å¯æŸ¥çœ‹æ‚¨çš„ç¶²ç«™ã€‚

**æ¨è–¦å·¥ä½œæµç¨‹**ï¼š

1. åœ¨ Notion ä¸­ä¿®æ”¹å…§å®¹ï¼ˆä¾‹å¦‚ï¼šå‹¾é¸/å–æ¶ˆå‹¾é¸ç™¼å¸ƒç‹€æ…‹ï¼‰
2. åŸ·è¡Œ `npm run sync` å¾ Notion åŒæ­¥æœ€æ–°æ•¸æ“šä¸¦é‡æ–°ç”Ÿæˆ
3. åŸ·è¡Œ `npm start` å•Ÿå‹•é è¦½æœå‹™å™¨
4. åœ¨ç€è¦½å™¨ä¸­è¨ªå• `http://localhost:3000` æŸ¥çœ‹æ›´æ–°å¾Œçš„å…§å®¹

> ğŸ’¡ **æç¤º**ï¼š
>
> - `npm run sync` æœƒè‡ªå‹•ä½¿ç”¨ `--fresh` é¸é …ï¼Œä¸ä½¿ç”¨ç·©å­˜ï¼Œç¢ºä¿ç²å– Notion çš„æœ€æ–°æ•¸æ“š
> - é è¦½ä¼ºæœå™¨æœƒæŒçºŒé‹è¡Œï¼ŒæŒ‰ `Ctrl + C` å¯åœæ­¢ä¼ºæœå™¨
> - å¦‚æœåªæ˜¯ä¿®æ”¹äº†ä¸»é¡Œæ¨£å¼ï¼Œä¹Ÿéœ€è¦åŸ·è¡Œ `npm run sync` é‡æ–°ç”Ÿæˆé é¢

## ğŸ“– ä½¿ç”¨èªªæ˜

### å¿«æ·å‘½ä»¤ï¼ˆæ¨è–¦ï¼‰

ç‚ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå°ˆæ¡ˆæä¾›äº†ä»¥ä¸‹ npm scriptsï¼š

```bash
# å¾ Notion åŒæ­¥æ•¸æ“šä¸¦ç”Ÿæˆç¶²ç«™ï¼ˆè‡ªå‹•ä½¿ç”¨ --fresh é¸é …ï¼‰
npm run sync

# å•Ÿå‹•æœ¬åœ°é è¦½ä¼ºæœå™¨
npm start
```

### å‘½ä»¤åˆ—å·¥å…·

#### `generate` - ç”Ÿæˆéœæ…‹ç¶²ç«™

```bash
node bin/cli.js generate <path_to_blog> [options]

é¸é …ï¼š
  -v, --verbose    é¡¯ç¤ºè©³ç´°æ—¥èªŒ
  --fresh          æ¸…é™¤å¿«å–é‡æ–°ç”Ÿæˆ
```

**ç­‰åŒæ–¼**ï¼š

```bash
npm run sync  # ç›¸ç•¶æ–¼ node bin/cli.js generate --fresh notablog-starter
```

#### `preview` - æœ¬åœ°é è¦½

```bash
node bin/cli.js preview <path_to_blog> [options]

é¸é …ï¼š
  -v, --verbose    é¡¯ç¤ºè©³ç´°æ—¥èªŒ
```

**ç­‰åŒæ–¼**ï¼š

```bash
npm start  # ç›¸ç•¶æ–¼ node bin/cli.js preview notablog-starter
```

### Notion æ•¸æ“šåŒæ­¥

ç•¶æ‚¨åœ¨ Notion ä¸­æ›´æ–°å…§å®¹å¾Œï¼Œéœ€è¦é‡æ–°ç”Ÿæˆç¶²ç«™æ‰èƒ½çœ‹åˆ°è®ŠåŒ–ï¼š

**æ–¹å¼ä¸€ï¼šä½¿ç”¨ npm scriptï¼ˆæ¨è–¦ï¼‰**

```bash
npm run sync
```

**æ–¹å¼äºŒï¼šä½¿ç”¨å®Œæ•´å‘½ä»¤**

```bash
# ä½¿ç”¨ --fresh é¸é …å¼·åˆ¶é‡æ–°æŠ“å– Notion æ•¸æ“š
node bin/cli.js generate --fresh notablog-starter

# æˆ–è€…æ‰‹å‹•åˆªé™¤ç·©å­˜å¾Œç”Ÿæˆ
rm -rf notablog-starter/cache
node bin/cli.js generate notablog-starter
```

> ğŸ’¡ **ç‚ºä»€éº¼éœ€è¦ `--fresh` é¸é …ï¼Ÿ**
>
> Notablog ä½¿ç”¨ç·©å­˜æ©Ÿåˆ¶ä¾†æé«˜æ€§èƒ½ï¼Œé¿å…æ¯æ¬¡éƒ½é‡æ–°å¾ Notion API æŠ“å–æ•¸æ“šã€‚ç•¶æ‚¨åœ¨ Notion ä¸­æ›´æ–°å…§å®¹å¾Œï¼Œéœ€è¦ä½¿ç”¨ `--fresh` é¸é …æˆ–åˆªé™¤ç·©å­˜ä¾†å¼·åˆ¶é‡æ–°æŠ“å–æœ€æ–°æ•¸æ“šã€‚

### å¤–éƒ¨é€£çµåŠŸèƒ½

åœ¨ Notion çš„ `url` æ¬„ä½ä¸­å¡«å…¥å®Œæ•´çš„ URLï¼ˆä»¥ `http://` æˆ– `https://` é–‹é ­ï¼‰ï¼Œç³»çµ±æœƒè‡ªå‹•è­˜åˆ¥ä¸¦è·³éæ¸²æŸ“ï¼Œç›´æ¥ä½¿ç”¨è©²é€£çµã€‚

**ç¯„ä¾‹**ï¼š

- `url: https://example.com` â†’ ç›´æ¥é€£çµåˆ°å¤–éƒ¨ç¶²ç«™
- `url: my-post` â†’ ç”Ÿæˆ `my-post.html`
- `url: ` (ç•™ç©º) â†’ è‡ªå‹•ç”Ÿæˆç¶²å€

### åœ–ç‰‡æ›´æ–°èˆ‡å¿«å–ç®¡ç†

#### ğŸ–¼ï¸ æ™ºèƒ½åœ–ç‰‡ç®¡ç†

ç•¶æ‚¨åœ¨ Notion ä¸­æ›¿æ›åœ–ç‰‡æ™‚ï¼ŒNotablog æœƒè‡ªå‹•è™•ç†åœ–ç‰‡çš„ä¸‹è¼‰å’Œæ¸…ç†ï¼š

**è‡ªå‹•æ¸…ç†è¢«æ›¿æ›çš„åœ–ç‰‡**ï¼š

- ç³»çµ±æœƒè¿½è¹¤æ¯å€‹é é¢ä½¿ç”¨çš„åœ–ç‰‡
- ç•¶é é¢çš„åœ–ç‰‡è¢«æ›¿æ›æ™‚ï¼ŒèˆŠåœ–ç‰‡æœƒè‡ªå‹•åˆªé™¤
- ä¸æœƒå½±éŸ¿å…¶ä»–é é¢çš„åœ–ç‰‡

**æ›´æ–° Notion åœ–ç‰‡çš„æ­¥é©Ÿ**ï¼š

1. åœ¨ Notion ä¸­æ›¿æ›åœ–ç‰‡
2. ç·¨è¼¯é é¢å…§å®¹ï¼ˆä¾‹å¦‚åŠ å€‹ç©ºæ ¼å†åˆªé™¤ï¼‰ä¾†è§¸ç™¼ `lastEditedTime` æ›´æ–°
3. åŸ·è¡Œç”Ÿæˆå‘½ä»¤ï¼š
   ```bash
   node bin/cli.js generate my-blog
   ```

**å¼·åˆ¶é‡æ–°ä¸‹è¼‰æ‰€æœ‰åœ–ç‰‡**ï¼š

å¦‚æœåœ–ç‰‡æ²’æœ‰æ›´æ–°ï¼Œå¯ä»¥æ¸…é™¤å¿«å–é‡æ–°ç”Ÿæˆï¼š

```bash
# æ¸…é™¤å¿«å–
find my-blog/cache -type f -delete

# é‡æ–°ç”Ÿæˆï¼ˆæœƒä¸‹è¼‰æœ€æ–°åœ–ç‰‡ä¸¦è‡ªå‹•åˆªé™¤èˆŠåœ–ç‰‡ï¼‰
node bin/cli.js generate my-blog
```

> ğŸ’¡ **æç¤º**ï¼šåœ–ç‰‡æª”æ¡ˆæœƒå„²å­˜åœ¨ `<your-blog>/public/assets/notion/` ç›®éŒ„ä¸­ï¼Œæª”åæ ¼å¼ç‚º `{blockId}-{filename}`
> 161:
> 162: #### ğŸ§¹ è‡ªå‹•åŒæ­¥æ¸…ç† (Pruning)
> 163:
> 164: Notablog æœƒè‡ªå‹•ä¿æŒæœ¬åœ°æª”æ¡ˆèˆ‡ Notion çš„ä¸€è‡´æ€§ï¼š
> 165: - ç•¶æ‚¨åœ¨ Notion ä¸­åˆªé™¤é é¢ã€å–æ¶ˆç™¼å¸ƒã€æˆ–æ›´æ”¹ URL æ™‚
> 166: - åŸ·è¡Œ `generate` å‘½ä»¤å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•è­˜åˆ¥ä¸¦åˆªé™¤ `public/` ä¸­éæ™‚çš„ `.html` æª”æ¡ˆ
> 167: - åŒæ™‚ä¹Ÿæœƒæ¸…ç† `public/tag/` ä¸­ä¸å†éœ€è¦çš„æ¨™ç±¤é é¢
> 168:
> 169: é€™ç¢ºä¿äº†æ‚¨çš„éƒ¨ç½²ç›®éŒ„å§‹çµ‚ä¿æŒä¹¾æ·¨ï¼Œä¸æœƒç´¯ç©ç„¡ç”¨çš„èˆŠæª”æ¡ˆã€‚

## ğŸ› ï¸ é–‹ç™¼æŒ‡å—

### å°ˆæ¡ˆçµæ§‹

```
notablog/
â”œâ”€â”€ bin/                  # CLI åŸ·è¡Œæª”
â”‚   â””â”€â”€ cli.js
â”œâ”€â”€ dist/                 # ç·¨è­¯å¾Œçš„ç¨‹å¼ç¢¼
â”‚   â”œâ”€â”€ index.js
â”‚   â””â”€â”€ index.esm.js
â”œâ”€â”€ src/                  # æºç¢¼
â”‚   â”œâ”€â”€ commands/         # CLI å‘½ä»¤
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ cache.ts          # å¿«å–ç®¡ç†
â”‚   â”œâ”€â”€ config.ts         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ parseTable.ts     # Notion è¡¨æ ¼è§£æ
â”‚   â”œâ”€â”€ renderPost.ts     # æ–‡ç« æ¸²æŸ“
â”‚   â”œâ”€â”€ renderer.ts       # æ¨¡æ¿æ¸²æŸ“å¼•æ“
â”‚   â””â”€â”€ templateProvider.ts # æ¨¡æ¿æä¾›è€…
â”œâ”€â”€ notablog-starter/     # ç¯„ä¾‹éƒ¨è½æ ¼
â””â”€â”€ package.json
```

### ä¿®æ”¹æºç¢¼

```bash
# é–‹ç™¼æ¨¡å¼ï¼ˆç›£è½æª”æ¡ˆè®Šæ›´ï¼‰
npm run dev

# ç·¨è­¯
npm run build:module

# åŸ·è¡Œæ¸¬è©¦
npm test
```

### è‡ªè¨‚ä¸»é¡Œ

ä¸»é¡Œæª”æ¡ˆä½æ–¼ `<your-blog>/themes/<theme-name>/`ï¼š

```
themes/pure-ejs/
â”œâ”€â”€ manifest.json         # ä¸»é¡Œé…ç½®
â”œâ”€â”€ assets/              # éœæ…‹è³‡æº
â”‚   â””â”€â”€ css/
â”‚       â””â”€â”€ theme.css
â””â”€â”€ layouts/             # æ¨¡æ¿æª”æ¡ˆ
    â”œâ”€â”€ index.html       # é¦–é 
    â”œâ”€â”€ post.html        # æ–‡ç« é 
    â”œâ”€â”€ tag.html         # æ¨™ç±¤é 
    â””â”€â”€ partials/        # éƒ¨åˆ†çµ„ä»¶
        â”œâ”€â”€ head.html
        â”œâ”€â”€ navbar.html
        â””â”€â”€ footer.html
```

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### æ ¸å¿ƒæŠ€è¡“

- **TypeScript** - å‹åˆ¥å®‰å…¨çš„é–‹ç™¼é«”é©—
- **EJS / Squirrelly** - éˆæ´»çš„æ¨¡æ¿å¼•æ“
- **Notion API** - é€é notionapi-agent å­˜å– Notion è³‡æ–™
- **NAST** - Notion Abstract Syntax Treeï¼Œç”¨æ–¼è™•ç† Notion å…§å®¹

### ä¸»è¦ä¿®æ”¹

æœ¬å°ˆæ¡ˆåŸºæ–¼ [dragonman225/notablog](https://github.com/dragonman225/notablog) ä¸¦é€²è¡Œäº†ä»¥ä¸‹æ”¹é€²ï¼š

1. **å¤–éƒ¨é€£çµæ”¯æ´**ï¼šåœ¨ `parseTable.ts` å’Œ `renderPost.ts` ä¸­æ–°å¢å¤–éƒ¨é€£çµæª¢æ¸¬
2. **æ™ºèƒ½åœ–ç‰‡ç®¡ç†**ï¼šè‡ªå‹•æ¸…ç†è¢«æ›¿æ›çš„èˆŠåœ–ç‰‡ï¼Œé¿å…ç´¯ç©ç„¡ç”¨æª”æ¡ˆ
3. **TypeScript é…ç½®å„ªåŒ–**ï¼šä¿®æ­£ `tsconfig.json` çš„ moduleResolution è¨­å®š
4. **æ¸²æŸ“å¼•æ“ä¿®å¾©**ï¼šä¿®æ­£ Squirrelly æ¸²æŸ“å™¨çš„åƒæ•¸å•é¡Œ
5. **å°ˆæ¡ˆçµæ§‹æ•´ç†**ï¼šç§»é™¤æœªä½¿ç”¨çš„æª”æ¡ˆå’Œé‡è¤‡é…ç½®
6. **è‡ªå‹•åŒæ­¥æ¸…ç†**ï¼šæ–°å¢ `pruneOrphanedFiles` é‚è¼¯ï¼Œè‡ªå‹•åˆªé™¤ Notion ä¸­å·²ç§»é™¤çš„æœ¬åœ° HTML æª”æ¡ˆ

## ğŸ“¤ éƒ¨ç½²

### GitHub Pages

1. ç”Ÿæˆç¶²ç«™ï¼š

```bash
node bin/cli.js generate notablog-starter
```

2. éƒ¨ç½² `notablog-starter/public/` ç›®éŒ„åˆ° GitHub Pages

### å…¶ä»–å¹³å°

ç”Ÿæˆçš„éœæ…‹ç¶²ç«™ä½æ–¼ `public/` ç›®éŒ„ï¼Œå¯ä»¥éƒ¨ç½²åˆ°ï¼š

- Netlify
- Vercel
- Cloudflare Pages
- ä»»ä½•éœæ…‹ç¶²ç«™è¨—ç®¡æœå‹™

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](LICENSE) æª”æ¡ˆ

## ğŸ™ è‡´è¬

- åŸå§‹å°ˆæ¡ˆï¼š[dragonman225/notablog](https://github.com/dragonman225/notablog)
- Notion APIï¼š[notionapi-agent](https://github.com/dragonman225/notionapi-agent)

---

## ğŸ“š è©³ç´°æ–‡æª”

æ›´å¤šä½¿ç”¨èªªæ˜è«‹åƒè€ƒ `notablog-starter/README.md`
